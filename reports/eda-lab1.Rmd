---
title: "EDA Análise de séries"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
  html_notebook:
    toc: yes
    toc_float: yes
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(here)
theme_set(theme_bw())
```

## Primeiramente, iremos carregar os dados das séries e filtrar as que queremos analisar. 

```{r}
poucas_temp = read.csv(here("data/series_from_imdb-all.csv")) %>% 
    filter(series_name %in% c("Arrow", "Vikings", "House of Cards", "American Horror Story"))
```


##Listagem das séries escolhidas


```{r}
poucas_temp %>%
    mutate(Séries = series_name, Temporadas = season) %>%
    select(Séries, Temporadas) %>%
    unique()

# Mostrar a quantidade de temporadas em cada série
```

As séries listadas foram escolhidas com o critério de similaridade ao número de temporadas e da quantidade
de votos que cada uma obteve durante as avaliações feitas pelo público.

Dessa forma, agora vamos fazer algumas observações sobre os gráficos e responder alguns questionamentos como: 

- Qual das séries que você escolheu é mais bem avaliada no IMDB? A diferença é grande? Pequena? Muda de acordo com as temporadas da série? 

Antes das observações serem feitas, é válido explicar um pouco cada conceito das análises que serão feitas com as séries:

- Média:
- Mediana:
- Percentil:
- Mínimo:
- Concentração:
- Dispersão:
- IQR:

##Quantidade de avaliações pelo IMDB

Com o bloxplot, podemos observar que os seriados possuem uma quantidade de votos concentrada em regiões próximas
a sua mediana. Alguns pontos ficaram fora do bloxplot, significa dizer que obteve quantidade de avaliações tanto abaixo, como acima dos quartis. Podemos observar claramente isto no seriado Arrow, com alguns pontos registrados bem acima do ponto de concentração dos votos, mostrando que alguns episódios houveram uma maior ou menor quantidade de avaliações. Já em American Horror Story, observamos uma concentração maior dos pontos no bloxplot, indicando a similaridade da quantidade de votos em cada episódio.

Obs.: Explicar sucintamente o que é bloxplot!
```{r}
poucas_temp %>%
    mutate(Séries = series_name) %>%
    ggplot(aes(x = series_name, y = UserVotes, color = Séries)) +
    geom_boxplot(width = .5) +
    ggtitle("Quantidade de avaliações de cada série pelo IMDB") +
    geom_jitter(width = .1, size = 2, alpha = .5) +
    xlab("Nomes das séries") +
    ylab("Quantidade de votos")

```

##Distribuição das avaliações dos episódios

O gráfico abaixo mostra as notas que cada episódio obteve nos seriados ao longo das temporadas e com isso, podemos 
observar que a maioria possui resultados entre o intervalo 7 a 9 nas avaliações. Citamos novamente a série Arrow, por obter algumas notas fora da concentração de pontos. Isto significa que em alguns episódios não corresponderam as
expectativas do público que avaliou a pesquisa.

Questionamento: Quem é mais concentrada? American ou as outras restantes?
```{r}
# usando a nota de avaliação
poucas_temp %>%
    mutate(Séries = series_name) %>%
    ggplot(aes(x = series_name, y = UserRating, color = Séries)) +
    geom_jitter(width = .4) +
    ggtitle("Distribuição das avaliações dos episódios") +
    ylim(5, 10) +
    labs(x = "Episódios", y = "Notas")
```

## Avaliações ao longo do tempo por temporada

```{r}
poucas_temp %>% 
    mutate(Séries = series_name) %>%
  ggplot(aes(x = season, y = UserRating, color = Séries)) + 
  geom_line() +
    ggtitle("Notas por temporada") +
    xlim(1,6) +
  geom_point() +
    xlab("Temporada") +
    ylab("Avaliação")
```

De acordo com o passar das temporadas, avaliação das séries observadas está no intervalo de notas entre 7,5 e 9,5.
No entanto, na quarta temporada de Arrow há uma queda brusca nas notas do público. Qual será o motivo do decaimento dessas notas? E na temporada posterior, o porquê do crescimento das notas? Google pesquisar :)


## Dados estatísticos de cada seriado

```{r}
# Mostrar numa tabela
sumarios = poucas_temp %>% 
    summarise(mediana = median(UserRating), 
              media = mean(UserRating))
poucas_temp %>%
    ggplot(aes(x = UserRating)) + 
    geom_histogram(binwidth = .5, fill = "white", color = "black") + 
    geom_vline(xintercept = sumarios$media, color = "darkorange") + 
    geom_vline(xintercept = sumarios$mediana, color = "brown") 
    

```

## Qual episódio mais bem avaliado?

``` {r}
# mudar os nomes dos títulos
poucas_temp %>%
    select(series_name, Episode, UserRating) %>%
    filter(UserRating == max(UserRating))
```


## Qual episódio mais mal avaliado?
``` {r}
# mudar os nomes dos títulos
poucas_temp %>%
    mutate(Série = series_name, Episódio = Episode, Avaliação = UserRating) %>%
    select(series_name, Episode, UserRating) %>%
    filter(UserRating == min(UserRating))
```
Comentário: Será uma relação de amor e ódio na série Arrow?

## Plot do gráfico entre amor e ódio

```{r}
#erro: amado_odiado
poucas_temp =  poucas_temp %>%
    mutate(
        rank_odiados = row_number(r1), # maior = mais odiado
        rank_amados = row_number(r10), # maior = mais amado
        amado_odiado = rank_amados * rank_odiados) # maior = mais amado E odiado
    
poucas_temp %>%
    ggplot(aes(x = r1,y = r10, color = season,
        size = amado_odiado,
        label = season_ep)) +
    geom_point(alpha = .7) +
    geom_text(nudge_x = .001, nudge_y = -.01)
```

*Comparação entre os dois episódios acima e as séries ao longo das temporadas*

*Conclusao da letra a*

Outro questionamento que podemos fazer é, qual das séries que você escolheu tem episódios de qualidade mais irregular segundo o IMDB? A diferença é grande? Pequena?

## Plot: Avaliação da série ao decorrer dos episódios

```{r}
poucas_temp %>%
    filter(series_name == "Arrow") %>%
    ggplot(aes(x = series_ep, y = UserRating, color = series_name)) +
    geom_line() +
    facet_wrap(~ series_name)

poucas_temp %>%
    filter(series_name == "Vikings") %>%
    ggplot(aes(x = series_ep, y = UserRating, color = series_name)) +
    geom_line() +
    facet_wrap(~ series_name)


poucas_temp %>%
    filter(series_name == "House of Cards") %>%
    ggplot(aes(x = series_ep, y = UserRating, color = series_name)) +
    geom_line() +
    facet_wrap(~ series_name)


poucas_temp %>%
    filter(series_name == "American Horror Story") %>%
    ggplot(aes(x = series_ep, y = UserRating, color = series_name)) +
    geom_line() +
    facet_wrap(~ series_name) 


```

A partir dos gráficos acima, podemos observar que nos últimos episódios American Horror Story são os mais mal avaliados pelos usuários. Devido ao que? Este decaimento está ligado...

## Quantidade de votos da série em cada temporada

##Houve série com crescimento na votação? E alguma caiu? 

```{r}
poucas_temp %>%
    filter(series_name == "Arrow") %>%
    ggplot(aes(x = season, y = UserVotes, fill = series_name)) +
    geom_col(position = position_identity()) +
    xlab("Séries") +
    ylab("Avaliação")

poucas_temp %>%
    filter(series_name == "Vikings") %>%
    ggplot(aes(x = season, y = UserVotes, fill = series_name)) +
    geom_col(position = position_identity()) +
    xlab("Séries") +
    ylab("Avaliação")

poucas_temp %>%
    filter(series_name == "House of Cards") %>%
    ggplot(aes(x = season, y = UserVotes, fill = series_name)) +
    geom_col(position = position_identity()) +
    xlab("Séries") +
    ylab("Avaliação")

poucas_temp %>%
    filter(series_name == "American Horror Story") %>%
    ggplot(aes(x = season, y = UserVotes, fill = series_name)) +
    geom_col(position = position_identity()) +
    xlab("Séries") +
    ylab("Avaliação")
```
Vikings obteve crescimento no número de votos, principalmente na quarta temporada devido... POr outro lado, esse número caiu na terceira e quarta temporada por tal motivo. Questionamento: será que cai o número de votos ao decorrer das temporadas?


*Conclusão da letra b*


